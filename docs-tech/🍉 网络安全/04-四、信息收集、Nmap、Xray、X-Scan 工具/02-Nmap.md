---
slug: /net-security/04/02
---

Nmap *Network mapper* å¼€æºçš„ç½‘ç»œæ¢æµ‹å’Œå®‰å…¨å®¡æ ¸çš„å·¥å…·ï¼Œè¯¥å·¥å…·è®¾è®¡ä¸»è¦æ˜¯ä¸ºäº†åˆ†æç½‘ç»œä¸»æœºã€æœåŠ¡å’Œå¼±ç‚¹ã€‚èƒ½åŠ›åŒ…æ‹¬ï¼š

- ç«¯å£æ‰«æã€‚åŒ…æ‹¬ TCPã€UDPã€SYN è¿˜æœ‰å…¶ä»–ã€‚
- æœåŠ¡æ¢æµ‹
- æ“ä½œç³»ç»ŸæŒ‡çº¹
- è„šæœ¬å¼•æ“ï¼šNmap æä¾›äº†ä¸€ä¸ªå«åš NSEï¼ˆNmap Scripting Engineï¼ŒNmap è„šæœ¬å¼•æ“ï¼‰ï¼Œèƒ½å¤Ÿæ‰§è¡Œç”¨æˆ·è‡ªå®šä¹‰çš„è„šæœ¬ã€‚
- å¼±ç‚¹æ¢æµ‹
- é«˜æ€§èƒ½å’Œä¼¸ç¼©æ€§ï¼šé«˜æ•ˆæ‰«æå¤§å‹ç½‘ç»œ
- çµæ´»çš„è¾“å‡ºï¼šTxtã€XML ç­‰
- è·¨å¹³å°

```bash {1}
â†’ nmap -A -T4 scanme.nmap.org
Starting Nmap 7.94 ( https://nmap.org ) at 2023-09-03 21:01 HKT
Nmap scan report for scanme.nmap.org (45.33.32.156)
Host is up (0.16s latency).
Other addresses for scanme.nmap.org (not scanned): 2600:3c01::f03c:91ff:fe18:bb2f
Not shown: 996 closed tcp ports (reset)
PORT      STATE    SERVICE    VERSION
22/tcp    open     ssh        OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.13 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   1024 ac:00:a0:1a:82:ff:cc:55:99:dc:67:2b:34:97:6b:75 (DSA)
|   2048 20:3d:2d:44:62:2a:b0:5a:9d:b5:b3:05:14:c2:a6:b2 (RSA)
|   256 96:02:bb:5e:57:54:1c:4e:45:2f:56:4c:4a:24:b2:57 (ECDSA)
|_  256 33:fa:91:0f:e0:e1:7b:1f:6d:05:a2:b0:f1:54:41:56 (ED25519)
80/tcp    filtered http
9929/tcp  open     nping-echo Nping echo
31337/tcp open     tcpwrapped
Device type: general purpose|WAP|storage-misc|media device|webcam
Running (JUST GUESSING): Linux 5.X|2.6.X|4.X (92%), Ubiquiti embedded (90%), HP embedded (89%), Infomir embedded (88%), Ubiquiti AirOS 5.X (88%), Tandberg embedded (88%)
OS CPE: cpe:/o:linux:linux_kernel:5.0 cpe:/o:linux:linux_kernel:2.6.32 cpe:/h:ubnt:airmax_nanostation cpe:/h:hp:p2000_g3 cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:2.6 cpe:/h:infomir:mag-250 cpe:/o:ubnt:airos:5.5.9
Aggressive OS guesses: Linux 5.0 (92%), Linux 5.0 - 5.4 (92%), Ubiquiti AirMax NanoStation WAP (Linux 2.6.32) (90%), HP P2000 G3 NAS device (89%), Linux 4.15 - 5.8 (89%), Linux 5.1 (89%), Linux 5.3 - 5.4 (89%), Linux 2.6.32 (89%), Infomir MAG-250 set-top box (88%), Linux 5.0 - 5.5 (88%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 19 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 80/tcp)
HOP RTT       ADDRESS
1   ...
2   0.47 ms   10.67.4.9
3   ...
4   0.86 ms   10.67.4.9
5   0.77 ms   10.67.4.24
6   ... 9
10  1.54 ms   172.21.161.62
11  4.04 ms   d1-161-230-143-118-on-nets.com (118.143.230.161)
12  4.35 ms   202.84.153.53
13  6.65 ms   unknown.telstraglobal.net (210.57.81.45)
14  155.77 ms i-92.eqnx03.telstraglobal.net (202.84.247.17)
15  157.64 ms i-10852.eqnx-core02.telstraglobal.net (202.84.140.2)
16  155.74 ms i-92.eqnx03.telstraglobal.net (202.84.247.17)
17  ... 18
19  154.28 ms scanme.nmap.org (45.33.32.156)

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 30.10 seconds
```

- `-A` å¼€å¯æ“ä½œç³»ç»Ÿæ¢æµ‹ï¼Œç‰ˆæœ¬æ¢æµ‹ï¼Œè„šæœ¬æ‰«æï¼Œä»¥åŠ tracerouteï¼ˆè¿½è¸ªè·¯ç”±ï¼‰
- `-T<0-5>` æ•°å­—è¶Šå¿«ï¼Œæ‰«æè¶Šå¿«







## ä¸»æœºå‘ç°

ä¸»æœºå‘ç°ï¼Œä¹Ÿå«åš Ping æ‰«æï¼ŒæŒ‡ä»ç½‘ç»œä¸­å¯»æ‰¾æ´»è·ƒä¸»æœºçš„è¿‡ç¨‹ã€‚

- `-sL` åˆ—è¡¨æ‰«æã€‚

  ä»…ä»…åˆ—å‡ºæŒ‡å®šç½‘ç»œä¸Šçš„æ¯å°ä¸»æœºï¼Œä¸å‘é€ä»»ä½•æŠ¥æ–‡åˆ°ç›®æ ‡ä¸»æœºï¼Œä¹Ÿå¹¶ä¸ç¡®å®šä¸»æœºæ˜¯å¦å­˜æ´»ï¼Œæ‰€ä»¥æ‰«æé€Ÿåº¦å¾ˆå¿«ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒNmap ä¼šå¯¹ä¸»æœºè¿›è¡Œåå‘åŸŸåè§£æä»¥è·å–ä»–ä»¬çš„åå­—ã€‚

> ï¼ˆæ­£å‘ï¼‰åŸŸåè§£æï¼šä»ä¸€ä¸ªåŸŸåè§£æå‡ºå®ƒçš„ IP åœ°å€ã€‚
>
> åå‘åŸŸåè§£æï¼šä»ä¸€ä¸ª IP åœ°å€è§£æå‡ºå®ƒçš„åŸŸåã€‚



- `-sP` Ping æ‰«æã€‚

  ä»…è¿›è¡Œ ping æ‰«æï¼Œç„¶åè¾“å‡ºå¯¹æ‰«æåšå‡ºå“åº”çš„é‚£äº›ä¸»æœºï¼Œæ²¡æœ‰è¿›ä¸€æ­¥çš„æµ‹è¯•ï¼ˆå¦‚ç«¯å£æ‰«ææˆ–è€…æ“ä½œç³»ç»Ÿæ¢æµ‹ï¼‰ã€‚

  å¯¹æ”»å‡»è€…æ¥è¯´ï¼Œäº†è§£å¤šå°‘ä¸»æœºæ­£åœ¨è¿è¡Œæ¯”åˆ—è¡¨æ‰«ææä¾›çš„ä¸€åˆ— IP å’Œä¸»æœºåå¾€å¾€æ›´æœ‰ä»·å€¼ã€‚

  å½“é˜²å®ˆä¸¥å¯†çš„é˜²ç«å¢™ä½äº Nmap çš„æºä¸»æœºå’Œç›®æ ‡ç½‘ç»œä¹‹é—´ï¼Œæ¨èä½¿ç”¨é‚£äº›é«˜çº§é€‰é¡¹ï¼Œå¦åˆ™ï¼Œå½“é˜²ç«å¢™æ•è·å¹¶ä¸¢å¼ƒæ¢æµ‹åŒ…æˆ–è€…å“åº”åŒ…æ—¶ï¼Œä¸€äº›ä¸»æœºå°±ä¸èƒ½è¢«æ¢æµ‹åˆ°ã€‚



## ç«¯å£æ‰«æåŸºç¡€

ç«¯å£æ‰«ææ˜¯ Nmap çš„æ ¸å¿ƒåŠŸèƒ½ã€‚

ä¼ ç»Ÿç«¯å£æ‰«æåªä¼šåˆ—å‡ºç«¯å£æ˜¯å¼€æ”¾æˆ–è€…å…³é—­çš„ï¼ŒNmap æœ‰æ›´å¤šçš„ä¿¡æ¯ç²’åº¦ï¼Œåˆ†ä¸º 6 ç§ï¼š

1. open

2. closed

   å…³é—­çŠ¶æ€ä¹Ÿæ˜¯æœ‰å“åº”çš„ï¼ˆæ¥å— Nmap çš„æ¢æµ‹æŠ¥æ–‡å¹¶å“åº”ï¼‰ä½†æ²¡æœ‰åº”ç”¨ç¨‹åºåœ¨å…¶ä¸Šç›‘å¬ã€‚

3. filtered

   å¯èƒ½è¢«é˜²ç«å¢™è¿‡æ»¤æ‰äº†ï¼Œæ— æ³•ç¡®å®šè¯¥ç«¯å£æ˜¯å¦å¼€æ”¾ã€‚

4. unfiltered

5. open|filtered

   æ— æ³•ç¡®å®šæ˜¯ open è¿˜æ˜¯ filtered

6. closed|filtered

   æ— æ³•ç¡®å®šæ˜¯ closed è¿˜æ˜¯ filtered

ğŸ¼ æ³¨æ„ï¼šè¿™äº›åˆ†ç±»æ˜¯ Nmap å®šä¹‰çš„ã€‚



## ç«¯å£æ‰«ææŠ€æœ¯

- `-sS` ï¼ˆTCP SYN æ‰«æï¼‰ğŸ”¥

  æ‰§è¡Œé€Ÿåº¦å¿«ã€‚SYN æ‰«ææ¯”è¾ƒéšè”½ï¼Œå› ä¸ºå®ƒä¸ä¼šå®Œæˆ TCP è¿æ¥ã€‚

- `-sT` ï¼ˆTCP connect() æ‰«æï¼‰ğŸ”¥

  å½“ SYN æ‰«æä¸å¯ç”¨çš„æ—¶å€™ï¼ŒTCP connect() å°±æ˜¯é»˜è®¤çš„æ‰«æé€‰é¡¹ã€‚å®ƒè°ƒç”¨ connect() ç³»ç»Ÿè¿æ¥ã€‚æ•ˆç‡æ¯”è¾ƒä½ï¼Œä¼šç•™ä¸‹ç—•è¿¹ã€‚

- `-sU` ï¼ˆUDP æ‰«æï¼‰ğŸ”¥

- `-sN; -sF; -sX` ï¼ˆTCP Nullï¼ŒFINï¼Œå’Œ Xmas æ‰«æï¼‰

- `-sA` ï¼ˆTCP ACK æ‰«æï¼‰

- `-sW` ï¼ˆTCP çª—å£æ‰«æï¼‰

- `-sM` ï¼ˆTCP Maimon æ‰«æï¼‰

- `--scanflags` ï¼ˆå®šåˆ¶çš„ TCP æ‰«æï¼‰

- `-sl  <zombie host[:probeport]>` ï¼ˆIdlescanï¼‰

- `-sO` ï¼ˆIP åè®®æ‰«æ)

- `-b` ï¼ˆFTP å¼¹è·³æ‰«æï¼‰



## ç«¯å£æ‰«æé¡ºåº

Nmap å¯¹ç«¯å£ 1~1024 ä»¥åŠ nmap-services åˆ—å‡ºçš„æ›´åˆ°çš„ç«¯å£è¿›è¡Œæ‰«æ

- `-p`ï¼ˆåªæ‰«ææŒ‡å®šçš„ç«¯å£ï¼‰

  æŒ‡å®šæƒ³æ‰«æçš„ç«¯å£

- `-F` ï¼ˆå¿«é€Ÿã€æœ‰é™çš„ç«¯å£æ‰«æï¼‰

  åœ¨ nmap-services ä¸­æŒ‡å®šæƒ³è¦æ‰«æçš„ç«¯å£ï¼Œæ¯”æ‰«ææ‰€æœ‰ 65535 ä¸ªç«¯å£å¿«å¾—å¤šã€‚

- `-r` ï¼ˆæŒ‰ç…§é¡ºåºè¿›è¡Œæ‰«æï¼‰

  é»˜è®¤æƒ…å†µä¸‹ï¼ŒNmap éšæœºæ‰«æï¼ˆå¸¸ç”¨ç«¯å£å…ˆæ‰«ï¼Œæé«˜æ•ˆç‡ï¼‰ï¼Œè¯¥é€‰é¡¹æŒ‡å®š Nmap é¡ºåºæ‰«æ



## æœåŠ¡å’Œç‰ˆæœ¬æ¢æµ‹

- `-sV` ï¼ˆç‰ˆæœ¬æ¢æµ‹ï¼‰ğŸ”¥

  æ‰“å¼€ç‰ˆæœ¬æ¢æµ‹ï¼Œä¹Ÿå¯ä»¥ç”¨ `-A` åŒæ—¶æ‰“å¼€ OS æ¢æµ‹å’Œç‰ˆæœ¬æ¢æµ‹

- `-allports` ï¼ˆä¸è·³è¿‡ä»»ä½•ç«¯å£ï¼‰ğŸ”¥

- `--version-intensity` ï¼ˆè®¾ç½®ç‰ˆæœ¬æ‰«æå¼ºåº¦ï¼‰

- `--version-light` ï¼ˆæ‰“å¼€è½»é‡çº§æ¨¡å¼ï¼‰

- `--version-all` ï¼ˆå°è¯•æ¯ä¸ªæ¢æµ‹ï¼‰

- `version-trace` ï¼ˆè·Ÿè¸ªç‰ˆæœ¬æ‰«ææ´»åŠ¨ï¼‰

- `-sR` ï¼ˆRPC æ‰«æï¼‰



## æ“ä½œç³»ç»Ÿæ¢æµ‹

- `-O` ï¼ˆå¯åŠ¨æ“ä½œç³»ç»Ÿæ£€æµ‹ï¼‰ğŸ”¥
- `--osscan-limit` ï¼ˆé’ˆå¯¹æŒ‡å®šçš„ç›®æ ‡è¿›è¡Œæ“ä½œç³»ç»Ÿæ£€æµ‹ï¼‰
- `--osscan-guess;-fuzzy` ï¼ˆæ¨æµ‹æ“ä½œç³»ç»Ÿæ£€æµ‹ç»“æœï¼‰

## æ—¶é—´å’Œæ€§èƒ½

- `-T <Paranoid | Sneaky | Polite | Normal | Aggresive | Insane>` è®¾ç½®æ—¶é—´æ¨¡æ¿

  å‰ä¸¤ç§ç”¨æˆ· IDS èº²é¿ã€‚Polite é™ä½æ‰«æé€Ÿåº¦ä»¥åŠä½¿ç”¨æ›´å°‘çš„å¸¦å®½å’Œç›®æ ‡ä¸»æœºèµ„æºã€‚Normal æœªåšä»»ä½•ä¼˜åŒ–ã€‚Aggressive åŠ é€Ÿæ‰«æã€‚Insane æœ€å¿«é€Ÿçš„æ‰«æã€‚



## é˜²ç«å¢™/IDS èº²é¿å’Œæ¬ºéª—

> IDS *Intrusion Detection System* å…¥ä¾µæ¢æµ‹ç³»ç»Ÿ

- `-f`ï¼ˆæŠ¥æ–‡åˆ†æ®µï¼‰ï¼›`--mtu`ï¼ˆä½¿ç”¨æŒ‡å®šçš„ MTUï¼‰ğŸ”¥

  ä½¿ç”¨å°ç‚¹ IP åŒ…åˆ†æ®µï¼Œè®©åŒ…è¿‡æ»¤å™¨ã€IDS ä»¥åŠå…¶ä»–å·¥å…·æ‰«ææ›´åŠ å›°éš¾ã€‚

- `-D <decoy1[, decoy2][, ME], ...>` ï¼ˆä½¿ç”¨è¯±é¥µéšè”½æ‰«æï¼‰

- `-S <IP_Address>` ï¼ˆæºåœ°å€æ¬ºéª—ï¼‰ğŸ”¥

  è®©ç›®æ ‡ä»¥ä¸ºæ˜¯å¦ä¸€ä¸ªåœ°å€åœ¨è¿›è¡Œæ‰«æã€‚

- `--source-port; -g` ï¼ˆæºç«¯å£æ¬ºéª—ï¼‰ğŸ”¥

- `--data-length`ï¼ˆå‘é€æŠ¥æ–‡æ—¶é™„åŠ éšæœºæ•°æ®ï¼‰ğŸ”¥

- `--ttl` ï¼ˆè®¾ç½® IP time-to-live åŸŸï¼‰

- `--randomize-hosts` ï¼ˆå¯¹ç›®æ ‡ä¸»æœºçš„é¡ºåºéšæœºæ’åˆ—ï¼‰

- `--spoof-mac <mac address, prefix, or vendor name>` ï¼ˆMAC åœ°å€æ¬ºéª—ï¼‰ğŸ”¥

## è¾“å‡º

Nmap æä¾› 5 ç§ä¸åŒçš„è¾“å‡ºæ ¼å¼ã€‚

- `-oN` ï¼ˆæ ‡å‡†è¾“å‡ºï¼‰
- `oX`ï¼ˆXML è¾“å‡ºï¼‰
- `-v` ï¼ˆæé«˜è¾“å‡ºä¿¡æ¯çš„è¯¦ç»†åº¦ï¼‰
- `-d [level]` ï¼ˆæé«˜æˆ–è®¾ç½®è°ƒè¯•çº§åˆ«ï¼‰



## å…¶ä»–

- `-6`ï¼ˆå¯åŠ¨ IPv6 æ‰«æï¼‰



## å®ä¾‹

```bash
# æ‰«æ scanme.nmap.org ä¸­æ‰€æœ‰çš„ä¿ç•™ TCP ç«¯å£ï¼Œé€‰é¡¹ -v å¯ç”¨ç»†èŠ‚æ¨¡å¼
nmap -v scanme.nmap.org

# è¿›è¡Œç§˜å¯† SYN æ‰«æï¼Œå¯¹è±¡ä¸ºä¸»æœº scanme æ‰€åœ¨çš„â€œC ç±»â€ç½‘æ®µçš„ 255 å°ä¸»æœºã€‚åŒæ—¶å°è¯•ç¡®å®šæ¯å°å·¥ä½œä¸»æœºçš„æ“ä½œç³»ç»Ÿç±»å‹ã€‚
nmap -sS -O scanme.nmap.org/24

# è¿›è¡Œä¸»æœºåˆ—ä¸¾å’Œ TCP æ‰«æã€‚å¯¹è±¡ä¸º B ç±» 198.116 ç½‘æ®µä¸­ 255 ä¸ª 8 ä½å­ç½‘ã€‚ç”¨æˆ·ç¡®å®šç³»ç»Ÿæ˜¯å¦è¿è¡Œäº† sshdã€DNSã€imapd æˆ– 4564 ç«¯å£ã€‚å¦‚æœè¿™äº›ç«¯å£æ‰“å¼€ï¼Œå°†ä½¿ç”¨ç‰ˆæœ¬æ£€æµ‹æ¥ç¡®å®šå“ªäº›åº”ç”¨åœ¨è¿è¡Œã€‚
nmap -sV -p 25,53,110,143,4564 198.116.0-255.1-127
```























